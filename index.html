<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
  <title>متجري - الورود والتغليف</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>

  <header>
    <h1>🌹 متجر الورود والتغليف 🌹</h1>
  </header>

  <div id="products-container" class="products"></div>

  <script>
    async function fetchProducts() {
      try {
        const res = await fetch("http://localhost:1337/api/products?populate=*");
        const data = await res.json();

        const container = document.getElementById("products-container");
        container.innerHTML = "";

        data.data.forEach(product => {
          const name = product.name || product.attributes?.name;
          const price = product.Price || product.attributes?.price;

          const description =
            (product.Description && product.Description[0]?.children[0]?.text) ||
            product.attributes?.description ||
            "بدون وصف";

          let imgUrl = "https://via.placeholder.com/300x200.png?text=No+Image";
          if (product.image && product.image[0]?.url) {
            imgUrl = "http://localhost:1337" + product.image[0].url;
          } else if (product.attributes?.image?.data) {
            imgUrl = "http://localhost:1337" + product.attributes.image.data.attributes.url;
          }

          container.innerHTML += `
            <div class="product">
              <img src="${imgUrl}" alt="${name}">
              <h3>${name}</h3>
              <p>${description}</p>
              <p class="price">💲 ${price}</p>
              <button>أضف إلى السلة</button>
            </div>
          `;
        });
      } catch (err) {
        console.error("❌ خطأ في جلب المنتجات:", err);
      }
    }

    fetchProducts();
  </script>
</body>
</html>
